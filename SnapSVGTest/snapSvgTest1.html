<!DOCTYPE html>
<html>
<style type="text/css">
	* { margin: 0; padding: 0; }
	html, body { height: 100%; width: 100%; }
	
	body
	{
		background-color: #000000;
		-moz-user-select:   none; 
	}
</style>	
<script type="text/javascript" src="commonFuncs.js"></script>  
<script src="../SnapSVG/dist/snap.svg.js"></script>
<script type="text/javascript" > 

	var FRAME_UPDATE_INTERVALE = 15;
	var raf = false;
	var frameCount = 0;
	var gameTimer, fpsTimer;
	var bigCircle;
	
	var pathArray1 = ["M 478.875,307.84375 C 472.1945,309.54954 465.72457,311.67919 458.59364,310.78125 452.63157,310.71355 446.65474,310.57504 440.96537,312.13598 432.6307,313.41629 425.27161,317.90708 417.32214,321.13989 409.42341,323.46856 403.7447,328.6588 397.03125,333.0625 397.08355,338.11121 390.34583,340.06893 388.6875,345.1875 387.03109,351.79726 380.091,356.71994 379.0625,364.875 373.74177,370.90163 373.20174,378.38763 372.125,384.97223 372.23404,400.38853 371.91327,415.83263 372.2664,431.22622 374.47466,442.66168 373.1242,454.37326 373.5,465.9375 376.45956,471.22964 378.827,476.81395 380.46875,482.65625 384.68227,487.93837 390.92464,492.01052 394.46875,496.65625 400.75442,494.91149 399.90705,503.8053 407.03125,500.84375 411.68828,502.16562 415.86882,504.45266 421.47223,503.59375 442.50721,503.57166 463.58833,503.63727 484.59375,503.5625 492.29067,498.81169 502.51924,499.92922 511.0168,497.43054 517.56188,490.67487 527.52679,496.09335 535.17108,492.64767 540.9873,488.76921 547.0075,487.01802 553.625,484.21875 558.14597,480.48315 561.86557,475.25544 566.40625,471.875 572.09162,468.25984 571.71816,462.28865 573.92912,457.1891 575.80187,452.26514 576.34309,446.95873 575.96875,441.16311 575.96711,423.58988 575.97098,405.99957 575.96875,388.4375 570.56756,380.63316 571.16599,370.81664 567.6875,362.25 562.82496,354.25479 560.63354,344.80525 559.40625,336.15625 559.81033,329.18142 552.65542,328.68723 549.82346,324.1242 542.35333,322.75848 537.29923,314.73736 530.09375,313.5625 525.11808,310.1101 518.0934,306.7803 511.11106,308 500.36754,307.90835 489.6105,308.19308 478.875,307.84375 z M 478.84375,308.875 C 492.14807,309.17072 505.48971,308.90481 518.78125,309 525.07737,312.61028 528.71611,313.02028 535.15625,317.1875 540.03212,321.61441 547.78986,322.69172 550.89057,327.59583 558.01131,328.90233 558.00718,335.52385 559.90625,341.0625 557.88992,350.9907 566.95614,357.58734 567.29934,366.75602 571.27279,374.65828 571.17465,383.58372 574.96875,391.3125 574.98422,411.03004 574.93441,430.75921 575,450.46875 571.53256,456.0442 572.60075,463.2373 568.15625,468.3125 566.10793,471.953 561.38002,474.08937 558.51293,478.0134 554.82035,484.30602 547.28013,484.19357 542.75885,488.40393 535.03908,490.67703 527.66981,494.98819 518.28125,492.8125 511.23472,497.00249 503.40974,497.56977 495.34375,499.84375 488.369,498.41372 483.56368,504.17579 476.53114,502.59375 455.73027,502.61355 434.9198,502.55355 414.125,502.625 410.15509,498.34436 400.97813,502.46064 398.96875,495.71875 392.80926,496.14623 389.7906,489.3874 384.64925,485.54184 378.54638,481.22104 379.793,472.45883 375.03179,467.00181 373.71933,457.24208 375.16551,447.0163 374.20396,437.11564 372.02953,425.23111 373.56453,413.08568 373.125,401.06903 373.13867,394.30264 373.10532,387.41106 373.125,380.75 375.00452,374.81507 378.75362,366.13966 381.9587,358.98593 386.29779,353.40032 388.24613,348.39095 391.3257,342.79369 396.8578,337.99247 397.56474,333.5265 403.61553,329.13782 409.9357,325.599 416.67088,322.17013 423.90165,319.25136 432.97303,315.30232 441.82874,311.89043 451.84723,311.78125 458.27863,311.42335 464.90012,312.56469 471.16022,311.14951 473.60155,310.06358 476.03587,308.45604 478.84375,308.875 z",
		"M 552.71875,262.3125 C 488.52541,262.67182 424.31487,262.36869 360.125,262.46875 347.63935,263.91676 336.51231,267.32335 324.51037,271.51149 307.79751,274.90008 292.21623,282.93324 278.4375,292.9375 265.19453,303.65332 256.87409,318.16664 246.59375,331.71875 240.52984,345.00039 233.34435,356.83974 226.03851,370.23082 224.46588,372.95144 226.79109,381.60135 222.625,380.1875 220.97786,392.33445 214.53823,403.17909 211.20672,413.9846 205.76686,424.55195 203.58931,436.36139 203.75,448.43537 203.82839,462.08155 203.6322,475.75168 203.75,489.375 206.51076,503.29669 207.35961,519.11624 220.5,528.34375 233.55958,536.73419 246.54561,540.65816 261.40242,544.77184 271.89839,549.71084 281.2591,548.57321 292.46875,553.28125 309.67946,554.07224 326.54397,557.98942 343.634,558.99371 396.09474,558.57926 448.57177,558.92726 501.03125,558.8125 508.60302,560.0136 530.23343,548.3319 525.8125,558.8125 533.50291,561.33107 522.28762,547.20934 532.01053,556.05525 535.10247,558.27129 541.15594,558.94504 543.90625,556.03125 550.89087,556.46568 558.27332,555.75953 563.21875,551.875 574.51426,548.45781 586.37377,551.02308 596.8125,545 606.9632,538.61763 617.79408,538.71296 627.51497,531.10665 643.37917,524.05265 655.13379,513.9935 661.53125,497.65625 662.36356,486.58021 665.42146,478.78622 668.59854,469.27891 667.76247,446.54867 669.594,423.66287 667.40625,401.03125 663.19454,389.07231 663.76021,373.55833 658.75,360.65625 658.61978,351.50214 653.41467,334.10842 653.125,329.59375 654.12599,323.56669 647.54146,312.15476 643.60077,306.12192 634.55959,294.64252 624.55313,283.4622 611.53125,276.25 607.73845,272.89989 596.70254,268.67768 589.5625,267.40625 577.24238,267.24985 565.6639,261.00432 552.71875,262.3125 z M 552.71875,263.3125 C 568.72037,264.59482 585.88468,266.77268 599.875,271.5 611.18149,275.34427 625.08505,284.99104 633.48236,296.53412 644.09164,304.96578 650.87752,317.8844 651.80883,330.86002 657.61198,346.91405 655.96361,364.77308 663.3125,380.375 661.88532,394.91024 669.83537,406.71256 667.4375,421.41596 666.85721,439.20939 668.70208,457.38205 666.32153,474.89323 661.97603,479.16041 662.37269,490.19513 660.5625,497.46875 654.54804,515.0934 640.18127,522.9651 624.90625,531.65625 613.66815,538.15804 602.15806,540.16001 590.5,546.78125 581.22856,549.23839 569.9869,547.91986 561.09375,552.3125 553.55014,555.39655 545.36385,555.31089 537.4375,556.5 536.69927,551.88214 530.54678,553.44394 527.09375,552.28125 524.69369,551.96442 508.06567,555.4996 518.84375,554.6875 497.01927,559.88443 474.03904,557.10756 451.57742,557.8125 411.60115,557.55142 371.54218,558.38245 331.63166,557.30098 313.31412,552.6925 293.90221,554.66005 276.16054,547.52479 260.44549,543.8055 244.71942,539.5887 230.71875,533.03125 218.36661,527.05121 205.43025,514.72721 207.67877,499.64959 203.514,488.61712 204.9097,476.73418 204.75,465.00852 204.57481,451.56393 204.39764,438.13897 207.40625,425.0625 212.01035,417.92995 212.12559,408.68041 217.53133,402.3199 221.62683,388.84848 225.31596,376.44694 229.53125,365.3125 237.60595,352.87906 242.57973,340.50468 250.31389,327.96165 261.84049,313.18323 271.29366,297.17329 287.94043,287.43803 300.35599,280.35479 313.16539,274.50506 327.21875,271.71875 342.92383,266.22421 358.94381,262.49192 375.66383,263.46875 434.68147,263.3683 493.70398,263.67163 552.71875,263.3125 z M 531.28125,553.96875 C 533.47436,553.46352 539.24665,556.66896 534.25,556.4375 L 531.28125,553.96875 z"	];
	
	function mainLoop()
	{	
		//console.log(exportTime()); 
		var r = bigCircle.attr("r");
		if(r<200)
			r++;
		else
			r = 0;
			
		bigCircle.attr({"r" : r});
		
		
		//var timeStamp = getTimeStamp();
		//var timePoint = toTimePoint(timeStamp);
		//var pathData = getPathDataByTimePoint(timePoint);
		//UpdatePathArray(pathData);
		
	}
	
	function render() 
	{  
		mainLoop();  
		requestAnimationFrame(render);  
	}  
	
	function startGameTimer()
	{
		function timer()
		{
			var loopUse = mainLoop();
			var refreshInterval = FRAME_UPDATE_INTERVALE - loopUse;
			if(refreshInterval < 0)
				refreshInterval = 0;
			gameTimer = window.setTimeout(timer, refreshInterval); 	
		}
		
		window.setTimeout(timer, FRAME_UPDATE_INTERVALE);
	}
	
	function gameStart()
	{
		if(raf){
			console.log("Support animation frame");
			render();
		}
		else{
			console.log("Not support animation frame");
			startGameTimer();
		}
	}

	window.onload = function() 
	{
		var now = new Date();
		console.log(now.getTime());
		
		raf = requestAnimationFrameSupport();
		
		// First lets create our drawing surface out of existing SVG element
		// If you want to create new surface just provide dimensions
		// like s = Snap(800, 600);
		var s = Snap("#svgRoot");
		var frontSvg = Snap("#svgFront");
		
		Snap.load("https://upload.wikimedia.org/wikipedia/commons/e/e8/BlankMap-World6-Equirectangular.svg", 
			function onSVGLoaded( data ){ 
				//data.select("#svg1926").attr({viewBox: "0 0 1000 1000"});
				data.select("#svg1926").attr({width: "100%"});
				data.select("#svg1926").attr({height: "100%"});
				s.append( data );
			
				//// Lets create big circle in the middle:
				bigCircle = frontSvg.circle(150, 150, 10);
				// By default its black, lets change its attributes
				bigCircle.attr({
					fill: "#bada55",
					stroke: "#000",
					strokeWidth: 5
				});
				
				//Start game
				gameStart();
				
				var d1 = [[10, 10], [100, 100] , [50, 180]];
				var d2 = [[120, 10], [300, 200] , [150, 30]];
				
				var d1Str = "M" + d1.join("L") + "Z";
				var d2Str = "M" + d2.join("L") + "Z";
				console.log(d1Str);
				
				var animatePath = frontSvg.path(d1Str).attr({
					fill: "#00cc66",
					stroke: "#000",
					strokeWidth: 5	
				});

				
				Snap.animate(0, 100, function(step) {
					var md = [ [(d2[0][0] - d1[0][0])/100 * step + d1[0][0] ,  (d2[0][1] - d1[0][1])/100 * step + d1[0][1] ],
					[(d2[1][0] - d1[1][0])/100 * step + d1[1][0] ,  (d2[1][1] - d1[1][1])/100 * step + d1[1][1] ],
					[(d2[2][0] - d1[2][0])/100 * step + d1[2][0] ,  (d2[2][1] - d1[2][1])/100 * step + d1[2][1] ]]
					var mdStr = "M" + md.join("L") + "Z";
					console.log(mdStr);
					animatePath.attr({
						d: mdStr
					});
				}, 20000);

			//
			//// Now lets create another small circle:
			//var smallCircle = s.circle(10, 15, 7);
			//
			//// Lets put this small circle and another one into a group:
			//var discs = s.group(smallCircle, s.circle(20, 15, 7));
			
		});
	}



</script>  
</head>  
  
<body oncontextmenu="return false" onselectstart="return false" oncopy="return false">
	<svg id="svgRoot" width="100%" height="100%" style="position:absolute" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg>
	<svg id="svgFront" width="100%" height="100%" style="position:absolute" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg>
 </body>   
</html>  